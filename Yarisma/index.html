<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yaşa Özel İslami Bilgi Yarışması (Revize Edilmiş)</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="quiz-container">
        <h1>Yaşa Özel İslami Bilgi Yarışması (Revize Edilmiş)</h1>

         <div id="name-entry">
             <div class="player-input-group">
                 <label for="player-1-name-input">Oyuncu 1 Adı:</label>
                 <input type="text" id="player-1-name-input" placeholder="İsim..." maxlength="20">
                 <label for="player-1-age-input">Yaşı (7-18):</label>
                 <input type="number" id="player-1-age-input" min="7" max="18" placeholder="Yaş...">
             </div>
              <div class="player-input-group">
                 <label for="player-2-name-input">Oyuncu 2 Adı:</label>
                 <input type="text" id="player-2-name-input" placeholder="İsim..." maxlength="20">
                 <label for="player-2-age-input">Yaşı (7-18):</label>
                 <input type="number" id="player-2-age-input" min="7" max="18" placeholder="Yaş...">
             </div>
             <div class="player-input-group">
                 <label for="player-3-name-input">Oyuncu 3 Adı:</label>
                 <input type="text" id="player-3-name-input" placeholder="İsim..." maxlength="20">
                 <label for="player-3-age-input">Yaşı (7-18):</label>
                 <input type="number" id="player-3-age-input" min="7" max="18" placeholder="Yaş...">
             </div>
             <div id="confirm-container">
                 <button id="confirm-names-button">Yarışmayı Başlat</button>
             </div>
            <p id="tts-support-warning">Tarayıcınız metin seslendirme özelliğini desteklemiyor olabilir.</p>
         </div>

         <div id="quiz-content">
              <div id="narration-area">
                <p id="narration-info">Şimdi dikkatle dinleyin...</p>
                <button id="play-narration-btn">Anlatımı Seslendir</button>
            </div>
            <div id="loading-indicator">Sıradaki sorular hazırlanıyor...</div>
            <div id="scoreboard">
                 <h3>Skor Tablosu</h3>
                 <ul id="scoreboard-list"></ul>
            </div>
            <div id="players-area">
                 <div class="player-quiz-area" id="player-area-1">
                     <div class="player-info">
                         <span class="player-name" id="player-1-name-display">Oyuncu 1</span>
                         <span class="player-age" id="player-1-age-display">(Yaş)</span>
                     </div>
                     <div class="player-question" id="question-player-1">Soru yükleniyor...</div>
                     <div class="player-options" id="options-player-1"></div>
                     <div class="player-feedback" id="feedback-player-1"></div>
                 </div>
                 <div class="player-quiz-area" id="player-area-2">
                      <div class="player-info">
                          <span class="player-name" id="player-2-name-display">Oyuncu 2</span>
                          <span class="player-age" id="player-2-age-display">(Yaş)</span>
                     </div>
                     <div class="player-question" id="question-player-2">Soru yükleniyor...</div>
                     <div class="player-options" id="options-player-2"></div>
                     <div class="player-feedback" id="feedback-player-2"></div>
                 </div>
                 <div class="player-quiz-area" id="player-area-3">
                       <div class="player-info">
                           <span class="player-name" id="player-3-name-display">Oyuncu 3</span>
                           <span class="player-age" id="player-3-age-display">(Yaş)</span>
                       </div>
                       <div class="player-question" id="question-player-3">Soru yükleniyor...</div>
                       <div class="player-options" id="options-player-3"></div>
                       <div class="player-feedback" id="feedback-player-3"></div>
                 </div>
            </div>
         </div>

         <div id="results">
              <h2>Yarışma Bitti!</h2>
              <div id="final-scores"></div>
              <p id="winner-info"></p>
              <button id="restart-button">Yeni Oyun (Yeni İsimlerle)</button>
         </div>

    </div> <script src="questions.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- Ses Efektleri (Yerel Dosyalar) ---
            // dogru.mp3 ve yanlis.mp3 dosyalarının index.html ile
            // AYNI KLASÖRDE olduğunu varsayar.
            let correctSound, incorrectSound;
            try {
                 correctSound = new Audio('dogru.mp3');
                 incorrectSound = new Audio('yanlis.mp3');

                 correctSound.onerror = () => console.error("Ses dosyası hatası: 'dogru.mp3' yüklenemedi. Dosya var mı ve aynı klasörde mi?");
                 incorrectSound.onerror = () => console.error("Ses dosyası hatası: 'yanlis.mp3' yüklenemedi. Dosya var mı ve aynı klasörde mi?");
            } catch (error) {
                console.error("Audio nesneleri oluşturulurken hata:", error);
                // Sesler olmadan devam etmesi için dummy objeler oluşturabiliriz (opsiyonel)
                 correctSound = { play: () => {}, onerror: null };
                 incorrectSound = { play: () => {}, onerror: null };
            }


            // --- KRİTİK KONTROL: Soru verisi yüklendi mi? ---
            if (typeof quizSegments === 'undefined' || typeof questionPool === 'undefined') {
                 console.error("!!! KRİTİK HATA: 'questions.js' yüklenemedi veya içindeki 'quizSegments'/'questionPool' değişkenleri bulunamadı!");
                 const container = document.getElementById('quiz-container');
                 if(container) {
                     container.innerHTML = `<h1>HATA!</h1><p style="color:red; font-weight:bold;">Yarışma verileri ('questions.js') yüklenemedi!</p><p> Lütfen dosyanın doğru yerde olduğundan, adının doğru yazıldığından ('questions.js') ve içinde hata olmadığından emin olun. index.html'deki script sırasını da kontrol edin.</p>`;
                     container.style.textAlign = 'center';
                 }
                 // Hata varsa script'in geri kalanını çalıştırma!
                 // Bu yüzden butonlar vs. çalışmaz.
                 return;
            }

            // --- Oyuncu Bilgileri, Değişkenler, Element Referansları ---
            // (Bu kısımlar önceki yanıttaki gibi kalacak, değişiklik yok)
            const players = [ /* ... oyuncu nesneleri ... */ ];
            let currentSegmentIndex = 0;
            let askedQuestionIds = [];
            const nameEntrySection = document.getElementById('name-entry');
            const confirmNamesButton = document.getElementById('confirm-names-button');
            // ... diğer tüm element referansları ...

             // --- Fonksiyon Tanımlamaları ---
             // (shuffleArray, updateScoreboard, getThemeClass, loadSegment, vb.
             //  TÜM fonksiyonlar önceki yanıttaki GÜNCEL halleriyle buraya gelecek)

             // Örnek olarak handleAnswer fonksiyonunun ses çalma kısmı:
             function handleAnswer(playerId, selectedOption) {
                 // ... (diğer kodlar: oyuncu bulma, cevap kontrolü vs.) ...

                 if (selectedOption === player.currentQuestion.correctAnswer) {
                    // ... (skor artırma, class ekleme vs.) ...
                    if (correctSound && typeof correctSound.play === 'function') { // Ses nesnesi varsa ve çalabiliyorsa
                        correctSound.play().catch(e => console.warn("Doğru ses çalınamadı:", e)); // Hataları yakala
                    }
                 } else {
                    // ... (yanlış cevap kodları, class ekleme vs.) ...
                    if (incorrectSound && typeof incorrectSound.play === 'function') { // Ses nesnesi varsa ve çalabiliyorsa
                         incorrectSound.play().catch(e => console.warn("Yanlış ses çalınamadı:", e)); // Hataları yakala
                     }
                 }

                 // ... (animasyonları kaldırma, skorbord güncelleme, tur kontrolü vs.) ...
             }

              // === DİĞER TÜM FONKSİYONLAR BURAYA EKLENMELİ ===
              // (initializeQuiz, startQuiz, resetToNameEntry vb. hepsi)
              // Önceki yanıtlardaki tam JavaScript kodunu buraya yapıştırın
              // (Ses tanımlamaları hariç, onlar yukarıda yapıldı)
              // =============================================


            // --- Başlangıç ---
            // resetToNameEntry fonksiyonu tanımlandıktan sonra çağrılmalı
            resetToNameEntry();

        }); // DOMContentLoaded Sonu
    </script>

</body>
</html>
